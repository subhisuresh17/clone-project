<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <meta charset="UTF-8">
    <title>Project List</title>
    <link rel="stylesheet" type="text/css" th:href="@{/css/projectList.css}">
        <!--/*/ <th:block th:include="fragments/head :: head"></th:block> /*/-->

</head>
<body>
    <header>
        <!--/*/ <th:block th:include="fragments/header :: header('assign-tasks')"></th:block> /*/-->
    </header>

<div class="container">

    <table>
        <thead>
        <tr>
            <th>Name</th>
            <th>Description</th>
            <th>Project Manager</th>
            <th>Due Date</th>
            <th>Actions</th>
            <th>Delete Project</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="project : ${projects}">
            <td th:text="${project.name}"></td>
            <td th:text="${project.description}"></td>
            <td th:text="${project.creator.name}"></td>
            <td th:text="${project.dueDate}"></td>
            <td>
                <a th:href="@{'/projects/' + ${project.id}}">Details</a>
            </td>
            <td>
                <button type="button" class="delete-button" th:onclick="'deleteProject(\'' + ${project.id} + '\')'">Delete</button>

            </td>
        </tr>
        </tbody>
    </table>
</div>

<!-- JavaScript function to handle delete project -->
<script th:inline="javascript">
    function deleteProject(projectId) {
        if (confirm('Are you sure you want to delete this project?')) {
            fetch('/projects/' + projectId, {
                method: 'DELETE',
            })
            .then(response => {
                if (response.ok) {
                    location.reload(); // Reload the page after successful deletion
                } else {
                    alert('Failed to delete project.');
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('Failed to delete project.');
            });
        }
    }
</script>

</body>
</html>
